{
  "Resources": {
    "DDBBEFDD151": {
      "Type": "AWS::DynamoDB::Table",
      "Properties": {
        "KeySchema": [
          {
            "AttributeName": "pk",
            "KeyType": "HASH"
          },
          {
            "AttributeName": "sk",
            "KeyType": "RANGE"
          }
        ],
        "AttributeDefinitions": [
          {
            "AttributeName": "pk",
            "AttributeType": "S"
          },
          {
            "AttributeName": "sk",
            "AttributeType": "S"
          },
          {
            "AttributeName": "gsi123sk",
            "AttributeType": "N"
          },
          {
            "AttributeName": "gsi3pk",
            "AttributeType": "N"
          }
        ],
        "BillingMode": "PAY_PER_REQUEST",
        "GlobalSecondaryIndexes": [
          {
            "IndexName": "GSI1",
            "KeySchema": [
              {
                "AttributeName": "pk",
                "KeyType": "HASH"
              },
              {
                "AttributeName": "gsi123sk",
                "KeyType": "RANGE"
              }
            ],
            "Projection": {
              "ProjectionType": "ALL"
            }
          },
          {
            "IndexName": "GSI2",
            "KeySchema": [
              {
                "AttributeName": "sk",
                "KeyType": "HASH"
              },
              {
                "AttributeName": "gsi123sk",
                "KeyType": "RANGE"
              }
            ],
            "Projection": {
              "ProjectionType": "ALL"
            }
          },
          {
            "IndexName": "GSI3",
            "KeySchema": [
              {
                "AttributeName": "gsi3pk",
                "KeyType": "HASH"
              },
              {
                "AttributeName": "gsi123sk",
                "KeyType": "RANGE"
              }
            ],
            "Projection": {
              "ProjectionType": "ALL"
            }
          }
        ]
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DDB/Resource"
      }
    },
    "DamageBossFightUuidServiceRoleDE020AC5": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageBossFightUuid/ServiceRole/Resource"
      }
    },
    "DamageBossFightUuidServiceRoleDefaultPolicy440A9E42": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "DDBBEFDD151",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "DDBBEFDD151",
                          "Arn"
                        ]
                      },
                      "/index/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "DamageBossFightUuidServiceRoleDefaultPolicy440A9E42",
        "Roles": [
          {
            "Ref": "DamageBossFightUuidServiceRoleDE020AC5"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageBossFightUuid/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "DamageBossFightUuid7487CDF0": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fS3Bucket18DF1292"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fS3VersionKey1DAF0CD7"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fS3VersionKey1DAF0CD7"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "DamageBossFightUuidServiceRoleDE020AC5",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "Environment": {
          "Variables": {
            "DDB_NAME": {
              "Ref": "DDBBEFDD151"
            }
          }
        },
        "MemorySize": 3008,
        "Timeout": 3
      },
      "DependsOn": [
        "DamageBossFightUuidServiceRoleDefaultPolicy440A9E42",
        "DamageBossFightUuidServiceRoleDE020AC5"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageBossFightUuid/Resource",
        "aws:asset:path": "asset.14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0f",
        "aws:asset:property": "Code"
      }
    },
    "DamageEncounterIdServiceRoleF7F9F71A": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageEncounterId/ServiceRole/Resource"
      }
    },
    "DamageEncounterIdServiceRoleDefaultPolicy8A91D0A1": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "DDBBEFDD151",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "DDBBEFDD151",
                          "Arn"
                        ]
                      },
                      "/index/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "DamageEncounterIdServiceRoleDefaultPolicy8A91D0A1",
        "Roles": [
          {
            "Ref": "DamageEncounterIdServiceRoleF7F9F71A"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageEncounterId/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "DamageEncounterIdE5BFEE58": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cS3Bucket2E66283D"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cS3VersionKey126575C6"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cS3VersionKey126575C6"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "DamageEncounterIdServiceRoleF7F9F71A",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "Environment": {
          "Variables": {
            "DDB_NAME": {
              "Ref": "DDBBEFDD151"
            }
          }
        },
        "MemorySize": 3008,
        "Timeout": 3
      },
      "DependsOn": [
        "DamageEncounterIdServiceRoleDefaultPolicy8A91D0A1",
        "DamageEncounterIdServiceRoleF7F9F71A"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageEncounterId/Resource",
        "aws:asset:path": "asset.381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61c",
        "aws:asset:property": "Code"
      }
    },
    "DamageCasterIdServiceRoleA8062BCF": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageCasterId/ServiceRole/Resource"
      }
    },
    "DamageCasterIdServiceRoleDefaultPolicy782114EE": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "dynamodb:BatchGetItem",
                "dynamodb:GetRecords",
                "dynamodb:GetShardIterator",
                "dynamodb:Query",
                "dynamodb:GetItem",
                "dynamodb:Scan"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "DDBBEFDD151",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "DDBBEFDD151",
                          "Arn"
                        ]
                      },
                      "/index/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "DamageCasterIdServiceRoleDefaultPolicy782114EE",
        "Roles": [
          {
            "Ref": "DamageCasterIdServiceRoleA8062BCF"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageCasterId/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "DamageCasterId481D9FFB": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4S3Bucket70570EDA"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4S3VersionKeyDCC92723"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4S3VersionKeyDCC92723"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "DamageCasterIdServiceRoleA8062BCF",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "Environment": {
          "Variables": {
            "DDB_NAME": {
              "Ref": "DDBBEFDD151"
            }
          }
        },
        "MemorySize": 3008,
        "Timeout": 3
      },
      "DependsOn": [
        "DamageCasterIdServiceRoleDefaultPolicy782114EE",
        "DamageCasterIdServiceRoleA8062BCF"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DamageCasterId/Resource",
        "aws:asset:path": "asset.a86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4",
        "aws:asset:property": "Code"
      }
    },
    "apiC8550315": {
      "Type": "AWS::ApiGateway::RestApi",
      "Properties": {
        "EndpointConfiguration": {
          "Types": [
            "REGIONAL"
          ]
        },
        "Name": "api"
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Resource"
      }
    },
    "apiDeployment149F12942ab36b3b43dd72aa936feb9f29d6881e": {
      "Type": "AWS::ApiGateway::Deployment",
      "Properties": {
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "Description": "Automatically created by the RestApi construct"
      },
      "DependsOn": [
        "apidamagebossfightbossfightuuidGET49F34844",
        "apidamagebossfightbossfightuuid1F13382A",
        "apidamagebossfight2CD42B26",
        "apidamagecastercasteridGETFA2203ED",
        "apidamagecastercasterid597DAD25",
        "apidamagecaster52BDE3DA",
        "apidamageencounterencounteridGETB4F7DF8E",
        "apidamageencounterencounteridA5AA1269",
        "apidamageencounter9B8D046A",
        "apidamageE61E8D84",
        "apiA9E0BAD5"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Deployment/Resource"
      }
    },
    "apiDeploymentStageprod896C8101": {
      "Type": "AWS::ApiGateway::Stage",
      "Properties": {
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "DeploymentId": {
          "Ref": "apiDeployment149F12942ab36b3b43dd72aa936feb9f29d6881e"
        },
        "StageName": "prod"
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/DeploymentStage.prod/Resource"
      }
    },
    "apiCloudWatchRoleAC81D93E": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "apigateway.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AmazonAPIGatewayPushToCloudWatchLogs"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/CloudWatchRole/Resource"
      }
    },
    "apiAccount57E28B43": {
      "Type": "AWS::ApiGateway::Account",
      "Properties": {
        "CloudWatchRoleArn": {
          "Fn::GetAtt": [
            "apiCloudWatchRoleAC81D93E",
            "Arn"
          ]
        }
      },
      "DependsOn": [
        "apiC8550315"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Account"
      }
    },
    "apiA9E0BAD5": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Fn::GetAtt": [
            "apiC8550315",
            "RootResourceId"
          ]
        },
        "PathPart": "api",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/Resource"
      }
    },
    "apidamageE61E8D84": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apiA9E0BAD5"
        },
        "PathPart": "damage",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/Resource"
      }
    },
    "apidamagebossfight2CD42B26": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamageE61E8D84"
        },
        "PathPart": "boss-fight",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/boss-fight/Resource"
      }
    },
    "apidamagebossfightbossfightuuid1F13382A": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamagebossfight2CD42B26"
        },
        "PathPart": "{boss-fight-uuid}",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/boss-fight/{boss-fight-uuid}/Resource"
      }
    },
    "apidamagebossfightbossfightuuidGETApiPermissionWowmateStackapi3548E701GETapidamagebossfightbossfightuuidF074FCDC": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageBossFightUuid7487CDF0",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/",
              {
                "Ref": "apiDeploymentStageprod896C8101"
              },
              "/GET/api/damage/boss-fight/{boss-fight-uuid}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/boss-fight/{boss-fight-uuid}/GET/ApiPermission.WowmateStackapi3548E701.GET..api.damage.boss-fight.{boss-fight-uuid}"
      }
    },
    "apidamagebossfightbossfightuuidGETApiPermissionTestWowmateStackapi3548E701GETapidamagebossfightbossfightuuidF6E17AFD": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageBossFightUuid7487CDF0",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/test-invoke-stage/GET/api/damage/boss-fight/{boss-fight-uuid}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/boss-fight/{boss-fight-uuid}/GET/ApiPermission.Test.WowmateStackapi3548E701.GET..api.damage.boss-fight.{boss-fight-uuid}"
      }
    },
    "apidamagebossfightbossfightuuidGET49F34844": {
      "Type": "AWS::ApiGateway::Method",
      "Properties": {
        "HttpMethod": "GET",
        "ResourceId": {
          "Ref": "apidamagebossfightbossfightuuid1F13382A"
        },
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "AuthorizationType": "NONE",
        "Integration": {
          "IntegrationHttpMethod": "POST",
          "Type": "AWS_PROXY",
          "Uri": {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":apigateway:",
                {
                  "Ref": "AWS::Region"
                },
                ":lambda:path/2015-03-31/functions/",
                {
                  "Fn::GetAtt": [
                    "DamageBossFightUuid7487CDF0",
                    "Arn"
                  ]
                },
                "/invocations"
              ]
            ]
          }
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/boss-fight/{boss-fight-uuid}/GET/Resource"
      }
    },
    "apidamageencounter9B8D046A": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamageE61E8D84"
        },
        "PathPart": "encounter",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/encounter/Resource"
      }
    },
    "apidamageencounterencounteridA5AA1269": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamageencounter9B8D046A"
        },
        "PathPart": "{encounter-id}",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/encounter/{encounter-id}/Resource"
      }
    },
    "apidamageencounterencounteridGETApiPermissionWowmateStackapi3548E701GETapidamageencounterencounterid234CB3FC": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageEncounterIdE5BFEE58",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/",
              {
                "Ref": "apiDeploymentStageprod896C8101"
              },
              "/GET/api/damage/encounter/{encounter-id}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/encounter/{encounter-id}/GET/ApiPermission.WowmateStackapi3548E701.GET..api.damage.encounter.{encounter-id}"
      }
    },
    "apidamageencounterencounteridGETApiPermissionTestWowmateStackapi3548E701GETapidamageencounterencounterid73F823C7": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageEncounterIdE5BFEE58",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/test-invoke-stage/GET/api/damage/encounter/{encounter-id}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/encounter/{encounter-id}/GET/ApiPermission.Test.WowmateStackapi3548E701.GET..api.damage.encounter.{encounter-id}"
      }
    },
    "apidamageencounterencounteridGETB4F7DF8E": {
      "Type": "AWS::ApiGateway::Method",
      "Properties": {
        "HttpMethod": "GET",
        "ResourceId": {
          "Ref": "apidamageencounterencounteridA5AA1269"
        },
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "AuthorizationType": "NONE",
        "Integration": {
          "IntegrationHttpMethod": "POST",
          "Type": "AWS_PROXY",
          "Uri": {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":apigateway:",
                {
                  "Ref": "AWS::Region"
                },
                ":lambda:path/2015-03-31/functions/",
                {
                  "Fn::GetAtt": [
                    "DamageEncounterIdE5BFEE58",
                    "Arn"
                  ]
                },
                "/invocations"
              ]
            ]
          }
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/encounter/{encounter-id}/GET/Resource"
      }
    },
    "apidamagecaster52BDE3DA": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamageE61E8D84"
        },
        "PathPart": "caster",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/caster/Resource"
      }
    },
    "apidamagecastercasterid597DAD25": {
      "Type": "AWS::ApiGateway::Resource",
      "Properties": {
        "ParentId": {
          "Ref": "apidamagecaster52BDE3DA"
        },
        "PathPart": "{caster-id}",
        "RestApiId": {
          "Ref": "apiC8550315"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/caster/{caster-id}/Resource"
      }
    },
    "apidamagecastercasteridGETApiPermissionWowmateStackapi3548E701GETapidamagecastercasterid92F5B269": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageCasterId481D9FFB",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/",
              {
                "Ref": "apiDeploymentStageprod896C8101"
              },
              "/GET/api/damage/caster/{caster-id}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/caster/{caster-id}/GET/ApiPermission.WowmateStackapi3548E701.GET..api.damage.caster.{caster-id}"
      }
    },
    "apidamagecastercasteridGETApiPermissionTestWowmateStackapi3548E701GETapidamagecastercasteridF1644A82": {
      "Type": "AWS::Lambda::Permission",
      "Properties": {
        "Action": "lambda:InvokeFunction",
        "FunctionName": {
          "Fn::GetAtt": [
            "DamageCasterId481D9FFB",
            "Arn"
          ]
        },
        "Principal": "apigateway.amazonaws.com",
        "SourceArn": {
          "Fn::Join": [
            "",
            [
              "arn:",
              {
                "Ref": "AWS::Partition"
              },
              ":execute-api:",
              {
                "Ref": "AWS::Region"
              },
              ":",
              {
                "Ref": "AWS::AccountId"
              },
              ":",
              {
                "Ref": "apiC8550315"
              },
              "/test-invoke-stage/GET/api/damage/caster/{caster-id}"
            ]
          ]
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/caster/{caster-id}/GET/ApiPermission.Test.WowmateStackapi3548E701.GET..api.damage.caster.{caster-id}"
      }
    },
    "apidamagecastercasteridGETFA2203ED": {
      "Type": "AWS::ApiGateway::Method",
      "Properties": {
        "HttpMethod": "GET",
        "ResourceId": {
          "Ref": "apidamagecastercasterid597DAD25"
        },
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "AuthorizationType": "NONE",
        "Integration": {
          "IntegrationHttpMethod": "POST",
          "Type": "AWS_PROXY",
          "Uri": {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":apigateway:",
                {
                  "Ref": "AWS::Region"
                },
                ":lambda:path/2015-03-31/functions/",
                {
                  "Fn::GetAtt": [
                    "DamageCasterId481D9FFB",
                    "Arn"
                  ]
                },
                "/invocations"
              ]
            ]
          }
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/Default/api/damage/caster/{caster-id}/GET/Resource"
      }
    },
    "apiCustomDomain64773C4F": {
      "Type": "AWS::ApiGateway::DomainName",
      "Properties": {
        "DomainName": "api.wmate.net",
        "EndpointConfiguration": {
          "Types": [
            "REGIONAL"
          ]
        },
        "RegionalCertificateArn": "arn:aws:acm:eu-central-1:940880032268:certificate/4159a4aa-6055-48ff-baa8-0b8379cdb494"
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/CustomDomain/Resource"
      }
    },
    "apiCustomDomainMapWowmateStackapi3548E701593058B2": {
      "Type": "AWS::ApiGateway::BasePathMapping",
      "Properties": {
        "DomainName": {
          "Ref": "apiCustomDomain64773C4F"
        },
        "RestApiId": {
          "Ref": "apiC8550315"
        },
        "Stage": {
          "Ref": "apiDeploymentStageprod896C8101"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/api/CustomDomain/Map:--=>WowmateStackapi3548E701/Resource"
      }
    },
    "FrontendBucketEFE2E19C": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true
        },
        "WebsiteConfiguration": {
          "IndexDocument": "index.html"
        }
      },
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/FrontendBucket/Resource"
      }
    },
    "FrontendBucketPolicy1DFF75D9": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "FrontendBucketEFE2E19C"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Principal": {
                "CanonicalUser": {
                  "Fn::GetAtt": [
                    "OAIE1EFC67F",
                    "S3CanonicalUserId"
                  ]
                }
              },
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "FrontendBucketEFE2E19C",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "FrontendBucketEFE2E19C",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/FrontendBucket/Policy/Resource"
      }
    },
    "OAIE1EFC67F": {
      "Type": "AWS::CloudFront::CloudFrontOriginAccessIdentity",
      "Properties": {
        "CloudFrontOriginAccessIdentityConfig": {
          "Comment": "Allows CloudFront to reach the bucket"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/OAI/Resource"
      }
    },
    "DistributionCFDistribution882A7313": {
      "Type": "AWS::CloudFront::Distribution",
      "Properties": {
        "DistributionConfig": {
          "Aliases": [
            "wmate.net"
          ],
          "CacheBehaviors": [
            {
              "AllowedMethods": [
                "GET",
                "HEAD"
              ],
              "CachedMethods": [
                "GET",
                "HEAD"
              ],
              "Compress": true,
              "ForwardedValues": {
                "Cookies": {
                  "Forward": "none"
                },
                "QueryString": false
              },
              "PathPattern": "/api/*",
              "TargetOriginId": "origin1",
              "ViewerProtocolPolicy": "redirect-to-https"
            }
          ],
          "CustomErrorResponses": [
            {
              "ErrorCode": 403,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            },
            {
              "ErrorCode": 404,
              "ResponseCode": 200,
              "ResponsePagePath": "/index.html"
            }
          ],
          "DefaultCacheBehavior": {
            "AllowedMethods": [
              "GET",
              "HEAD"
            ],
            "CachedMethods": [
              "GET",
              "HEAD"
            ],
            "Compress": true,
            "ForwardedValues": {
              "Cookies": {
                "Forward": "none"
              },
              "QueryString": false
            },
            "TargetOriginId": "origin2",
            "ViewerProtocolPolicy": "redirect-to-https"
          },
          "DefaultRootObject": "index.html",
          "Enabled": true,
          "HttpVersion": "http2",
          "IPV6Enabled": true,
          "Origins": [
            {
              "CustomOriginConfig": {
                "HTTPPort": 80,
                "HTTPSPort": 443,
                "OriginKeepaliveTimeout": 5,
                "OriginProtocolPolicy": "https-only",
                "OriginReadTimeout": 30,
                "OriginSSLProtocols": [
                  "TLSv1.2"
                ]
              },
              "DomainName": "api.wmate.net",
              "Id": "origin1"
            },
            {
              "DomainName": {
                "Fn::GetAtt": [
                  "FrontendBucketEFE2E19C",
                  "RegionalDomainName"
                ]
              },
              "Id": "origin2",
              "S3OriginConfig": {
                "OriginAccessIdentity": {
                  "Fn::Join": [
                    "",
                    [
                      "origin-access-identity/cloudfront/",
                      {
                        "Ref": "OAIE1EFC67F"
                      }
                    ]
                  ]
                }
              }
            }
          ],
          "PriceClass": "PriceClass_100",
          "ViewerCertificate": {
            "AcmCertificateArn": "arn:aws:acm:us-east-1:940880032268:certificate/613f33d4-230b-49d9-8e06-be177f135e0d",
            "MinimumProtocolVersion": "TLSv1.2_2018",
            "SslSupportMethod": "sni-only"
          }
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Distribution/CFDistribution"
      }
    },
    "DeployWebsiteCustomResourceD116527B": {
      "Type": "Custom::CDKBucketDeployment",
      "Properties": {
        "ServiceToken": {
          "Fn::GetAtt": [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536",
            "Arn"
          ]
        },
        "SourceBucketNames": [
          {
            "Ref": "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3Bucket49B1045C"
          }
        ],
        "SourceObjectKeys": [
          {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3VersionKey933A3A91"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3VersionKey933A3A91"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        ],
        "DestinationBucketName": {
          "Ref": "FrontendBucketEFE2E19C"
        },
        "DistributionId": {
          "Ref": "DistributionCFDistribution882A7313"
        }
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/DeployWebsite/CustomResource/Default"
      }
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/Resource"
      }
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":s3:::",
                      {
                        "Ref": "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3Bucket49B1045C"
                      }
                    ]
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":s3:::",
                      {
                        "Ref": "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3Bucket49B1045C"
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "FrontendBucketEFE2E19C",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "FrontendBucketEFE2E19C",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "cloudfront:GetInvalidation",
                "cloudfront:CreateInvalidation"
              ],
              "Effect": "Allow",
              "Resource": "*"
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "Roles": [
          {
            "Ref": "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C81C01536": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430S3Bucket13DFEC6A"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430S3VersionKeyED938FBC"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430S3VersionKeyED938FBC"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "index.handler",
        "Role": {
          "Fn::GetAtt": [
            "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265",
            "Arn"
          ]
        },
        "Runtime": "python3.6",
        "Timeout": 900
      },
      "DependsOn": [
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRoleDefaultPolicy88902FDF",
        "CustomCDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756CServiceRole89A01265"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Custom::CDKBucketDeployment8693BB64968944B69AAFB0CC9EB8756C/Resource",
        "aws:asset:path": "asset.f50156b06e01f1dc6e1cd9ed0a8a839ed83b6e01c5b88cb83ec14da0322221cf.zip",
        "aws:asset:property": "Code"
      }
    },
    "CloudTrailS310CD22F2": {
      "Type": "AWS::S3::Bucket",
      "UpdateReplacePolicy": "Retain",
      "DeletionPolicy": "Retain",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/S3/Resource"
      }
    },
    "CloudTrailS3PolicyEA49A03E": {
      "Type": "AWS::S3::BucketPolicy",
      "Properties": {
        "Bucket": {
          "Ref": "CloudTrailS310CD22F2"
        },
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:GetBucketAcl",
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudtrail.amazonaws.com"
              },
              "Resource": {
                "Fn::GetAtt": [
                  "CloudTrailS310CD22F2",
                  "Arn"
                ]
              }
            },
            {
              "Action": "s3:PutObject",
              "Condition": {
                "StringEquals": {
                  "s3:x-amz-acl": "bucket-owner-full-control"
                }
              },
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudtrail.amazonaws.com"
              },
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    {
                      "Fn::GetAtt": [
                        "CloudTrailS310CD22F2",
                        "Arn"
                      ]
                    },
                    "/AWSLogs/",
                    {
                      "Ref": "AWS::AccountId"
                    },
                    "/*"
                  ]
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/S3/Policy/Resource"
      }
    },
    "CloudTrailLogGroupABA1792E": {
      "Type": "AWS::Logs::LogGroup",
      "Properties": {
        "RetentionInDays": 365
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/LogGroup"
      }
    },
    "CloudTrailLogsRole9F6E6663": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "cloudtrail.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/LogsRole/Resource"
      }
    },
    "CloudTrailLogsRoleDefaultPolicyD9019B15": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "logs:PutLogEvents",
                "logs:CreateLogStream"
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "CloudTrailLogGroupABA1792E",
                  "Arn"
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "CloudTrailLogsRoleDefaultPolicyD9019B15",
        "Roles": [
          {
            "Ref": "CloudTrailLogsRole9F6E6663"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/LogsRole/DefaultPolicy/Resource"
      }
    },
    "CloudTrailA62D711D": {
      "Type": "AWS::CloudTrail::Trail",
      "Properties": {
        "IsLogging": true,
        "S3BucketName": {
          "Ref": "CloudTrailS310CD22F2"
        },
        "CloudWatchLogsLogGroupArn": {
          "Fn::GetAtt": [
            "CloudTrailLogGroupABA1792E",
            "Arn"
          ]
        },
        "CloudWatchLogsRoleArn": {
          "Fn::GetAtt": [
            "CloudTrailLogsRole9F6E6663",
            "Arn"
          ]
        },
        "EnableLogFileValidation": true,
        "EventSelectors": [
          {
            "IncludeManagementEvents": true,
            "ReadWriteType": "WriteOnly"
          },
          {
            "DataResources": [
              {
                "Type": "AWS::S3::Object",
                "Values": [
                  {
                    "Fn::Join": [
                      "",
                      [
                        {
                          "Fn::GetAtt": [
                            "Upload51C4D210",
                            "Arn"
                          ]
                        },
                        "/"
                      ]
                    ]
                  }
                ]
              }
            ],
            "ReadWriteType": "WriteOnly"
          }
        ],
        "IncludeGlobalServiceEvents": true,
        "IsMultiRegionTrail": true
      },
      "DependsOn": [
        "CloudTrailLogsRoleDefaultPolicyD9019B15",
        "CloudTrailLogsRole9F6E6663",
        "CloudTrailS3PolicyEA49A03E"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/CloudTrail/Resource"
      }
    },
    "Upload51C4D210": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true
        }
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Upload/Resource"
      }
    },
    "UploadcwEvent9EBEA7EE": {
      "Type": "AWS::Events::Rule",
      "Properties": {
        "EventPattern": {
          "source": [
            "aws.s3"
          ],
          "detail-type": [
            "AWS API Call via CloudTrail"
          ],
          "detail": {
            "resources": {
              "ARN": [
                {
                  "Fn::GetAtt": [
                    "Upload51C4D210",
                    "Arn"
                  ]
                }
              ]
            },
            "eventName": [
              "PutObject",
              "CompleteMultipartUpload"
            ]
          }
        },
        "State": "ENABLED",
        "Targets": [
          {
            "Arn": {
              "Ref": "StateMachine2E01A3A5"
            },
            "Id": "Target0",
            "RoleArn": {
              "Fn::GetAtt": [
                "StateMachineEventsRoleDBCDECD1",
                "Arn"
              ]
            }
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Upload/cwEvent/Resource"
      }
    },
    "Parquet0583A65D": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true
        }
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Parquet/Resource"
      }
    },
    "AthenaBC8BA882": {
      "Type": "AWS::S3::Bucket",
      "Properties": {
        "PublicAccessBlockConfiguration": {
          "BlockPublicAcls": true,
          "BlockPublicPolicy": true,
          "IgnorePublicAcls": true,
          "RestrictPublicBuckets": true
        }
      },
      "UpdateReplacePolicy": "Delete",
      "DeletionPolicy": "Delete",
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Athena/Resource"
      }
    },
    "SizeServiceRole85ACF342": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Size/ServiceRole/Resource"
      }
    },
    "SizeServiceRoleDefaultPolicy679486E5": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "Upload51C4D210",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "Upload51C4D210",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "SizeServiceRoleDefaultPolicy679486E5",
        "Roles": [
          {
            "Ref": "SizeServiceRole85ACF342"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Size/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "Size1348CF6C": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588S3BucketCCE966AD"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588S3VersionKey133D13FD"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588S3VersionKey133D13FD"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "SizeServiceRole85ACF342",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "MemorySize": 128,
        "Timeout": 3
      },
      "DependsOn": [
        "SizeServiceRoleDefaultPolicy679486E5",
        "SizeServiceRole85ACF342"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Size/Resource",
        "aws:asset:path": "asset.c97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588",
        "aws:asset:property": "Code"
      }
    },
    "ParquetFuncServiceRoleD3930363": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/ParquetFunc/ServiceRole/Resource"
      }
    },
    "ParquetFuncServiceRoleDefaultPolicyEA45EFA0": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "Upload51C4D210",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "Upload51C4D210",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "s3:PutObject*",
                "s3:Abort*"
              ],
              "Effect": "Allow",
              "Resource": {
                "Fn::Join": [
                  "",
                  [
                    {
                      "Fn::GetAtt": [
                        "Parquet0583A65D",
                        "Arn"
                      ]
                    },
                    "/*"
                  ]
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "ParquetFuncServiceRoleDefaultPolicyEA45EFA0",
        "Roles": [
          {
            "Ref": "ParquetFuncServiceRoleD3930363"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/ParquetFunc/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "ParquetFunc529177BD": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676S3BucketC9C3A034"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676S3VersionKey5694E404"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676S3VersionKey5694E404"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "ParquetFuncServiceRoleD3930363",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "Environment": {
          "Variables": {
            "TARGET_BUCKET_NAME": {
              "Ref": "Parquet0583A65D"
            }
          }
        },
        "MemorySize": 3008,
        "Timeout": 720
      },
      "DependsOn": [
        "ParquetFuncServiceRoleDefaultPolicyEA45EFA0",
        "ParquetFuncServiceRoleD3930363"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/ParquetFunc/Resource",
        "aws:asset:path": "asset.28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676",
        "aws:asset:property": "Code"
      }
    },
    "AthenaFuncServiceRoleE90FC0F8": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/AthenaFunc/ServiceRole/Resource"
      }
    },
    "AthenaFuncServiceRoleDefaultPolicyC094F34C": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "Parquet0583A65D",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "Parquet0583A65D",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*",
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AthenaBC8BA882",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AthenaBC8BA882",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "athena:ListWorkGroups",
                "athena:GetExecutionEngine",
                "athena:GetExecutionEngines",
                "athena:GetNamespace",
                "athena:GetCatalogs",
                "athena:GetNamespaces",
                "athena:GetTables",
                "athena:GetTable",
                "glue:GetTable"
              ],
              "Effect": "Allow",
              "Resource": "*"
            },
            {
              "Action": [
                "athena:StartQueryExecution",
                "athena:GetQueryResults",
                "athena:DeleteNamedQuery",
                "athena:GetNamedQuery",
                "athena:ListQueryExecutions",
                "athena:StopQueryExecution",
                "athena:GetQueryResultsStream",
                "athena:ListNamedQueries",
                "athena:CreateNamedQuery",
                "athena:GetQueryExecution",
                "athena:BatchGetNamedQuery",
                "athena:BatchGetQueryExecution",
                "athena:GetWorkGroup"
              ],
              "Effect": "Allow",
              "Resource": "arn:aws:athena:eu-central-1:940880032268:workgroup/primary"
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "AthenaFuncServiceRoleDefaultPolicyC094F34C",
        "Roles": [
          {
            "Ref": "AthenaFuncServiceRoleE90FC0F8"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/AthenaFunc/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "AthenaFunc4D447344": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fS3Bucket086A413C"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fS3VersionKey35845551"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fS3VersionKey35845551"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "AthenaFuncServiceRoleE90FC0F8",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "MemorySize": 3008,
        "Timeout": 3
      },
      "DependsOn": [
        "AthenaFuncServiceRoleDefaultPolicyC094F34C",
        "AthenaFuncServiceRoleE90FC0F8"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/AthenaFunc/Resource",
        "aws:asset:path": "asset.c83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6f",
        "aws:asset:property": "Code"
      }
    },
    "CheckServiceRoleE80C0897": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Check/ServiceRole/Resource"
      }
    },
    "CheckServiceRoleDefaultPolicyEAF7FF84": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:DeleteObject*",
                "s3:PutObject*",
                "s3:Abort*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AthenaBC8BA882",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AthenaBC8BA882",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "athena:ListWorkGroups",
                "athena:GetExecutionEngine",
                "athena:GetExecutionEngines",
                "athena:GetNamespace",
                "athena:GetCatalogs",
                "athena:GetNamespaces",
                "athena:GetTables",
                "athena:GetTable",
                "glue:GetTable"
              ],
              "Effect": "Allow",
              "Resource": "*"
            },
            {
              "Action": [
                "athena:StartQueryExecution",
                "athena:GetQueryResults",
                "athena:DeleteNamedQuery",
                "athena:GetNamedQuery",
                "athena:ListQueryExecutions",
                "athena:StopQueryExecution",
                "athena:GetQueryResultsStream",
                "athena:ListNamedQueries",
                "athena:CreateNamedQuery",
                "athena:GetQueryExecution",
                "athena:BatchGetNamedQuery",
                "athena:BatchGetQueryExecution",
                "athena:GetWorkGroup"
              ],
              "Effect": "Allow",
              "Resource": "arn:aws:athena:eu-central-1:940880032268:workgroup/primary"
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "CheckServiceRoleDefaultPolicyEAF7FF84",
        "Roles": [
          {
            "Ref": "CheckServiceRoleE80C0897"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Check/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "Check8FEA48D3": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eS3BucketC5C08092"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eS3VersionKey2950A01E"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eS3VersionKey2950A01E"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "CheckServiceRoleE80C0897",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "MemorySize": 3008,
        "Timeout": 3
      },
      "DependsOn": [
        "CheckServiceRoleDefaultPolicyEAF7FF84",
        "CheckServiceRoleE80C0897"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Check/Resource",
        "aws:asset:path": "asset.b1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675e",
        "aws:asset:property": "Code"
      }
    },
    "ImportServiceRole569FC065": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "ManagedPolicyArns": [
          {
            "Fn::Join": [
              "",
              [
                "arn:",
                {
                  "Ref": "AWS::Partition"
                },
                ":iam::aws:policy/service-role/AWSLambdaBasicExecutionRole"
              ]
            ]
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Import/ServiceRole/Resource"
      }
    },
    "ImportServiceRoleDefaultPolicy012F45E1": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": [
                "s3:GetObject*",
                "s3:GetBucket*",
                "s3:List*"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "AthenaBC8BA882",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "AthenaBC8BA882",
                          "Arn"
                        ]
                      },
                      "/*"
                    ]
                  ]
                }
              ]
            },
            {
              "Action": [
                "dynamodb:BatchWriteItem",
                "dynamodb:PutItem",
                "dynamodb:UpdateItem",
                "dynamodb:DeleteItem"
              ],
              "Effect": "Allow",
              "Resource": [
                {
                  "Fn::GetAtt": [
                    "DDBBEFDD151",
                    "Arn"
                  ]
                },
                {
                  "Fn::Join": [
                    "",
                    [
                      {
                        "Fn::GetAtt": [
                          "DDBBEFDD151",
                          "Arn"
                        ]
                      },
                      "/index/*"
                    ]
                  ]
                }
              ]
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "ImportServiceRoleDefaultPolicy012F45E1",
        "Roles": [
          {
            "Ref": "ImportServiceRole569FC065"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Import/ServiceRole/DefaultPolicy/Resource"
      }
    },
    "Import98530AF4": {
      "Type": "AWS::Lambda::Function",
      "Properties": {
        "Code": {
          "S3Bucket": {
            "Ref": "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3S3Bucket34FF87F6"
          },
          "S3Key": {
            "Fn::Join": [
              "",
              [
                {
                  "Fn::Select": [
                    0,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3S3VersionKey724DAFA8"
                        }
                      ]
                    }
                  ]
                },
                {
                  "Fn::Select": [
                    1,
                    {
                      "Fn::Split": [
                        "||",
                        {
                          "Ref": "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3S3VersionKey724DAFA8"
                        }
                      ]
                    }
                  ]
                }
              ]
            ]
          }
        },
        "Handler": "main",
        "Role": {
          "Fn::GetAtt": [
            "ImportServiceRole569FC065",
            "Arn"
          ]
        },
        "Runtime": "go1.x",
        "Environment": {
          "Variables": {
            "DDB_NAME": {
              "Ref": "DDBBEFDD151"
            },
            "LOG_LEVEL": "prod"
          }
        },
        "MemorySize": 3008,
        "Timeout": 10
      },
      "DependsOn": [
        "ImportServiceRoleDefaultPolicy012F45E1",
        "ImportServiceRole569FC065"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/Import/Resource",
        "aws:asset:path": "asset.0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3",
        "aws:asset:property": "Code"
      }
    },
    "StateMachineRoleB840431D": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": {
                  "Fn::Join": [
                    "",
                    [
                      "states.",
                      {
                        "Ref": "AWS::Region"
                      },
                      ".amazonaws.com"
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/StateMachine/Role/Resource"
      }
    },
    "StateMachineRoleDefaultPolicyDF1E6607": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "Size1348CF6C",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "ParquetFunc529177BD",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "AthenaFunc4D447344",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "Check8FEA48D3",
                  "Arn"
                ]
              }
            },
            {
              "Action": "lambda:InvokeFunction",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "Import98530AF4",
                  "Arn"
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "StateMachineRoleDefaultPolicyDF1E6607",
        "Roles": [
          {
            "Ref": "StateMachineRoleB840431D"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/StateMachine/Role/DefaultPolicy/Resource"
      }
    },
    "StateMachine2E01A3A5": {
      "Type": "AWS::StepFunctions::StateMachine",
      "Properties": {
        "DefinitionString": {
          "Fn::Join": [
            "",
            [
              "{\"StartAt\":\"Size Job\",\"States\":{\"Size Job\":{\"Next\":\"Check file sizeFunc\",\"Type\":\"Task\",\"Resource\":\"",
              {
                "Fn::GetAtt": [
                  "Size1348CF6C",
                  "Arn"
                ]
              },
              "\"},\"Check file sizeFunc\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.file_size\",\"NumericGreaterThan\":16,\"Next\":\"File too big\"}],\"Default\":\"Parquet Job\"},\"Parquet Job\":{\"Next\":\"Input for Athena\",\"Type\":\"Task\",\"Resource\":\"",
              {
                "Fn::GetAtt": [
                  "ParquetFunc529177BD",
                  "Arn"
                ]
              },
              "\"},\"Input for Athena\":{\"Type\":\"Pass\",\"Result\":[{\"result_bucket\":\"",
              {
                "Ref": "AthenaBC8BA882"
              },
              "\",\"query\":\"\\n                    SELECT cl.damage, ei.encounter_id, cl.boss_fight_uuid, cl.caster_id, cl.caster_name\\n                    FROM (SELECT SUM(actual_amount) AS damage, caster_name, caster_id, boss_fight_uuid\\n                          FROM  \\\"wowmate\\\".\\\"combatlogs\\\"\\n                          WHERE caster_type LIKE '0x5%' AND caster_name != 'nil' \\n                          GROUP BY caster_name, caster_id, boss_fight_uuid\\n                          ) AS cl\\n                    JOIN (SELECT encounter_id, boss_fight_uuid\\n                          FROM \\\"wowmate\\\".\\\"combatlogs\\\"\\n                          WHERE event_type = 'ENCOUNTER_START'\\n                          GROUP BY encounter_id, boss_fight_uuid) AS ei\\n                          ON cl.boss_fight_uuid = ei.boss_fight_uuid\\n                          \\n                    ORDER BY encounter_id, damage DESC\\n                \",\"region\":\"eu-central-1\",\"database\":\"wowmate\"}],\"Next\":\"Athena Job\"},\"Athena Job\":{\"Next\":\"Set wait time\",\"Type\":\"Task\",\"Resource\":\"",
              {
                "Fn::GetAtt": [
                  "AthenaFunc4D447344",
                  "Arn"
                ]
              },
              "\"},\"Set wait time\":{\"Type\":\"Pass\",\"Result\":3,\"ResultPath\":\"$.wait_time\",\"InputPath\":\"$\",\"OutputPath\":\"$\",\"Next\":\"Wait X Seconds\"},\"Wait X Seconds\":{\"Type\":\"Wait\",\"SecondsPath\":\"$.wait_time\",\"Next\":\"Check Athena Status Job\"},\"Check Athena Status Job\":{\"Next\":\"Detect duplicate combatlogs\",\"Retry\":[{\"ErrorEquals\":[\"States.ALL\"],\"IntervalSeconds\":2,\"MaxAttempts\":10}],\"Type\":\"Task\",\"Resource\":\"",
              {
                "Fn::GetAtt": [
                  "Check8FEA48D3",
                  "Arn"
                ]
              },
              "\"},\"Detect duplicate combatlogs\":{\"Type\":\"Pass\",\"Result\":false,\"ResultPath\":\"$.duplicate\",\"InputPath\":\"$\",\"OutputPath\":\"$\",\"Next\":\"Check if log already exists\"},\"Check if log already exists\":{\"Type\":\"Choice\",\"Choices\":[{\"Variable\":\"$.duplicate\",\"StringEquals\":\"true\",\"Next\":\"Combatlog duplicate\"}],\"Default\":\"DynamoDB Job\"},\"DynamoDB Job\":{\"End\":true,\"Type\":\"Task\",\"Resource\":\"",
              {
                "Fn::GetAtt": [
                  "Import98530AF4",
                  "Arn"
                ]
              },
              "\"},\"Combatlog duplicate\":{\"Type\":\"Fail\",\"Error\":\"combatlog is already in the database\"},\"File too big\":{\"Type\":\"Fail\",\"Error\":\"parquetJob returned FAILED\",\"Cause\":\"File too big\"}}}"
            ]
          ]
        },
        "RoleArn": {
          "Fn::GetAtt": [
            "StateMachineRoleB840431D",
            "Arn"
          ]
        }
      },
      "DependsOn": [
        "StateMachineRoleDefaultPolicyDF1E6607",
        "StateMachineRoleB840431D"
      ],
      "Metadata": {
        "aws:cdk:path": "WowmateStack/StateMachine/Resource"
      }
    },
    "StateMachineEventsRoleDBCDECD1": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "Service": "events.amazonaws.com"
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/StateMachine/EventsRole/Resource"
      }
    },
    "StateMachineEventsRoleDefaultPolicyFB602CA9": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "states:StartExecution",
              "Effect": "Allow",
              "Resource": {
                "Ref": "StateMachine2E01A3A5"
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "StateMachineEventsRoleDefaultPolicyFB602CA9",
        "Roles": [
          {
            "Ref": "StateMachineEventsRoleDBCDECD1"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/StateMachine/EventsRole/DefaultPolicy/Resource"
      }
    },
    "ClientRole910E33D4": {
      "Type": "AWS::IAM::Role",
      "Properties": {
        "AssumeRolePolicyDocument": {
          "Statement": [
            {
              "Action": "sts:AssumeRole",
              "Effect": "Allow",
              "Principal": {
                "AWS": {
                  "Fn::Join": [
                    "",
                    [
                      "arn:",
                      {
                        "Ref": "AWS::Partition"
                      },
                      ":iam::940880032268:root"
                    ]
                  ]
                }
              }
            }
          ],
          "Version": "2012-10-17"
        }
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/ClientRole/Resource"
      }
    },
    "ClientRoleDefaultPolicy6F610F20": {
      "Type": "AWS::IAM::Policy",
      "Properties": {
        "PolicyDocument": {
          "Statement": [
            {
              "Action": "s3:PutObject",
              "Effect": "Allow",
              "Resource": {
                "Fn::GetAtt": [
                  "Upload51C4D210",
                  "Arn"
                ]
              }
            }
          ],
          "Version": "2012-10-17"
        },
        "PolicyName": "ClientRoleDefaultPolicy6F610F20",
        "Roles": [
          {
            "Ref": "ClientRole910E33D4"
          }
        ]
      },
      "Metadata": {
        "aws:cdk:path": "WowmateStack/ClientRole/DefaultPolicy/Resource"
      }
    }
  },
  "Parameters": {
    "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fS3Bucket18DF1292": {
      "Type": "String",
      "Description": "S3 bucket for asset \"14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0f\""
    },
    "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fS3VersionKey1DAF0CD7": {
      "Type": "String",
      "Description": "S3 key for asset version \"14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0f\""
    },
    "AssetParameters14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0fArtifactHashF01264EE": {
      "Type": "String",
      "Description": "Artifact hash for asset \"14bc835aaecc2b9bcf7ce17b1fe6be8f695321c5f6a841a71230ca915c3a8d0f\""
    },
    "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cS3Bucket2E66283D": {
      "Type": "String",
      "Description": "S3 bucket for asset \"381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61c\""
    },
    "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cS3VersionKey126575C6": {
      "Type": "String",
      "Description": "S3 key for asset version \"381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61c\""
    },
    "AssetParameters381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61cArtifactHash2C0B51A8": {
      "Type": "String",
      "Description": "Artifact hash for asset \"381f49a76833a714eb8a9a296953509cc7208414211c46682b62dfebf9b6f61c\""
    },
    "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4S3Bucket70570EDA": {
      "Type": "String",
      "Description": "S3 bucket for asset \"a86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4\""
    },
    "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4S3VersionKeyDCC92723": {
      "Type": "String",
      "Description": "S3 key for asset version \"a86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4\""
    },
    "AssetParametersa86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4ArtifactHashB0FDDDA8": {
      "Type": "String",
      "Description": "Artifact hash for asset \"a86ce22dd98927c9e865781bf9e9400074af8a2fd6b25491296a4526463ec8d4\""
    },
    "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430S3Bucket13DFEC6A": {
      "Type": "String",
      "Description": "S3 bucket for asset \"6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430\""
    },
    "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430S3VersionKeyED938FBC": {
      "Type": "String",
      "Description": "S3 key for asset version \"6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430\""
    },
    "AssetParameters6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430ArtifactHash55E30580": {
      "Type": "String",
      "Description": "Artifact hash for asset \"6416c21be320b522db64c705872c0a54d788e3df57b34a5f0d1e8602d7521430\""
    },
    "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3Bucket49B1045C": {
      "Type": "String",
      "Description": "S3 bucket for asset \"322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712\""
    },
    "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712S3VersionKey933A3A91": {
      "Type": "String",
      "Description": "S3 key for asset version \"322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712\""
    },
    "AssetParameters322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712ArtifactHashDEC4D471": {
      "Type": "String",
      "Description": "Artifact hash for asset \"322915a98891c17a073493ada4e2ddc54dac8ebe84b2dfb9455256084b832712\""
    },
    "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588S3BucketCCE966AD": {
      "Type": "String",
      "Description": "S3 bucket for asset \"c97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588\""
    },
    "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588S3VersionKey133D13FD": {
      "Type": "String",
      "Description": "S3 key for asset version \"c97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588\""
    },
    "AssetParametersc97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588ArtifactHash4C84EDDF": {
      "Type": "String",
      "Description": "Artifact hash for asset \"c97ae202254f6b18ecb01d391180a770ffe2ff3b2e496df356b40a74f5e3c588\""
    },
    "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676S3BucketC9C3A034": {
      "Type": "String",
      "Description": "S3 bucket for asset \"28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676\""
    },
    "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676S3VersionKey5694E404": {
      "Type": "String",
      "Description": "S3 key for asset version \"28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676\""
    },
    "AssetParameters28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676ArtifactHash8EBA4337": {
      "Type": "String",
      "Description": "Artifact hash for asset \"28a62f8b0a275e52158f9e28f7853f2e5b6ec833222ca4cdf21a314932dd5676\""
    },
    "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fS3Bucket086A413C": {
      "Type": "String",
      "Description": "S3 bucket for asset \"c83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6f\""
    },
    "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fS3VersionKey35845551": {
      "Type": "String",
      "Description": "S3 key for asset version \"c83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6f\""
    },
    "AssetParametersc83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6fArtifactHash1E4FF54E": {
      "Type": "String",
      "Description": "Artifact hash for asset \"c83d63d38e20635d96c5d8e07bf1198294a680a590f54a347114fef7e5258f6f\""
    },
    "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eS3BucketC5C08092": {
      "Type": "String",
      "Description": "S3 bucket for asset \"b1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675e\""
    },
    "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eS3VersionKey2950A01E": {
      "Type": "String",
      "Description": "S3 key for asset version \"b1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675e\""
    },
    "AssetParametersb1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675eArtifactHashECBE5666": {
      "Type": "String",
      "Description": "Artifact hash for asset \"b1fef38c4cec63868e634183c3336c18863380581d899aac1da20a902c08675e\""
    },
    "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3S3Bucket34FF87F6": {
      "Type": "String",
      "Description": "S3 bucket for asset \"0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3\""
    },
    "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3S3VersionKey724DAFA8": {
      "Type": "String",
      "Description": "S3 key for asset version \"0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3\""
    },
    "AssetParameters0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3ArtifactHashF27E00C8": {
      "Type": "String",
      "Description": "Artifact hash for asset \"0a2d431e8c43eb07a9aa2b6cdf1eba6ad21eb665383ce561bbf69249939077a3\""
    }
  },
  "Outputs": {
    "apiEndpoint9349E63C": {
      "Value": {
        "Fn::Join": [
          "",
          [
            "https://",
            {
              "Ref": "apiC8550315"
            },
            ".execute-api.",
            {
              "Ref": "AWS::Region"
            },
            ".",
            {
              "Ref": "AWS::URLSuffix"
            },
            "/",
            {
              "Ref": "apiDeploymentStageprod896C8101"
            },
            "/"
          ]
        ]
      }
    }
  }
}